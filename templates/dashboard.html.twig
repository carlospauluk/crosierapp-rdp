{% extends '@CrosierLibBase/index.html.twig' %}


{% block page_content %}



    <div class="container-fluid">
        <div class="animated fadeIn">


            <!-- Resultado Vendas -->
            {% if is_granted('ROLE_RELVENDAS') %}

                <div class="row mt-3">
                    <div class="col-sm-12">

                        <div class="card">

                            <div class="card-header">
                                <div class="d-flex flex-wrap align-items-center">
                                    <div class="d-sm-flex text-nowrap mr-1">
                                        <h3>Resultado Vendas</h3>
                                    </div>
                                </div>
                            </div>


                            <div class="card-body">

                                <div class="row">
                                    <div class="col-xl-6">

                                        <div class="card">
                                            <div class="card-header">
                                                <h4>Total por Fornecedor</h4>
                                            </div>
                                            <div class="card-body">

                                                <div class="form-group row">
                                                    <label class="col-form-label col-sm-2"
                                                           for="filter_chartVendasTotalPorFornecedor_dts">Período</label>
                                                    <div class="col-sm-10">
                                                        <div class="input-group">
                                                            <input type="text"
                                                                   class="form-control"
                                                                   id="filter_chartVendasTotalPorFornecedor_dts"
                                                                   name="filter[chartVendasTotalPorFornecedor][dts]"
                                                                   data-mask="00/00/0000 - 00/00/0000"
                                                                   style="width: 180px; text-align: center"
                                                                   value="{{ filter.chartVendasTotalPorFornecedor.dts|default('') }}">
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="form-group row">
                                                    <label class="col-form-label col-sm-2"
                                                           for="filter_chartVendasTotalPorFornecedor_grupos">Grupos</label>
                                                    <div class="col-sm-10">
                                                        <div class="input-group">
                                                            <select id="filter_chartVendasTotalPorFornecedor_grupos"
                                                                    name="filter[chartVendasTotalPorFornecedor][grupos]"
                                                                    class="form-control"
                                                                    multiple
                                                                    data-options="{{ grupos }}"
                                                                    data-val="{{ filter.chartVendasTotalPorFornecedor.grupos }}"></select>

                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="form-group row">
                                                    <label class="col-form-label col-sm-2"
                                                           for="filter_chartVendasTotalPorFornecedor_lojas">Lojas</label>
                                                    <div class="col-sm-8">
                                                        <div class="input-group">
                                                            <select id="filter_chartVendasTotalPorFornecedor_lojas"
                                                                    name="filter[chartVendasTotalPorFornecedor][lojas]"
                                                                    class="form-control"
                                                                    multiple
                                                                    data-options="{{ lojas }}"
                                                                    data-val="{{ filter.chartVendasTotalPorFornecedor.lojas }}"></select>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-2">
                                                        <button id="btnFiltrar_chartVendasTotalPorFornecedor"
                                                                class="btn btn-primary ml-2"><i
                                                                    class="fas fa-search"></i> Filtrar
                                                        </button>
                                                    </div>
                                                </div>

                                                <div id="chart_vendasTotalPorFornecedor" style="height: 450px"></div>

                                                <div class="text-right">
                                                    <a role="button" class="btn btn-outline-primary" href="{{ url('relVendas01_relatorioTotalPorFornecedor', {'dts': filter.chartVendasTotalPorFornecedor.dts|default(''), 'grupo': filter.chartVendasTotalPorFornecedor.grupos, 'lojas': filter.chartVendasTotalPorFornecedor.lojas}) }}"
                                                       id="btnRelatorioVendasPorFornecedor">
                                                        <i class="fas fa-file-alt"></i> Abrir relatório</a>
                                                </div>

                                            </div>
                                        </div>

                                    </div>

                                    <div class="col-xl-6">

                                        <div class="card">
                                            <div class="card-header">
                                                <h4>Total por Vendedor</h4>
                                            </div>
                                            <div class="card-body">

                                                <div class="form-group row">
                                                    <label class="col-form-label col-sm-2"
                                                           for="filter_chartVendasTotalPorVendedor_dts">Período</label>
                                                    <div class="col-sm-10">
                                                        <div class="input-group">
                                                            <input type="text"
                                                                   class="form-control"
                                                                   id="filter_chartVendasTotalPorVendedor_dts"
                                                                   name="filter[chartVendasTotalPorVendedor][dts]"
                                                                   data-mask="00/00/0000 - 00/00/0000"
                                                                   style="width: 180px; text-align: center"
                                                                   value="{{ filter.chartVendasTotalPorVendedor.dts|default('') }}">
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="form-group row">
                                                    <label class="col-form-label col-sm-2"
                                                           for="filter_chartVendasTotalPorVendedor_grupos">Grupos</label>
                                                    <div class="col-sm-10">
                                                        <div class="input-group">
                                                            <select id="filter_chartVendasTotalPorVendedor_grupos"
                                                                    name="filter[chartVendasTotalPorVendedor][grupos]"
                                                                    class="form-control"
                                                                    multiple
                                                                    data-options="{{ grupos }}"
                                                                    data-val="{{ filter.chartVendasTotalPorVendedor.grupos }}"></select>

                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="form-group row">
                                                    <label class="col-form-label col-sm-2"
                                                           for="filter_chartVendasTotalPorVendedor_lojas">Lojas</label>
                                                    <div class="col-sm-8">
                                                        <div class="input-group">
                                                            <select id="filter_chartVendasTotalPorVendedor_lojas"
                                                                    name="filter[chartVendasTotalPorVendedor][lojas]"
                                                                    class="form-control"
                                                                    multiple
                                                                    data-options="{{ lojas }}"
                                                                    data-val="{{ filter.chartVendasTotalPorVendedor.lojas }}"></select>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-2">
                                                        <button id="btnFiltrar_chartVendasTotalPorVendedor"
                                                                class="btn btn-primary ml-2"><i
                                                                    class="fas fa-search"></i> Filtrar
                                                        </button>
                                                    </div>
                                                </div>

                                                <div id="chart_vendasTotalPorVendedor" style="height: 450px"></div>


                                                <div class="d-flex justify-content-center">
                                                    Rentabilidade Geral: <span
                                                            id="chart_totalPorVendedor_rentabilidade"
                                                            style="font-weight: bold"> </span>
                                                </div>

                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col text-right" style="font-size: smaller; color: lightgrey">
                                        Atualizado em : <b>{{ relVendas01_dthrAtualizacao|date('d/m/Y H:i:s') }}</b>
                                    </div>
                                </div>

                            </div>
                        </div>


                    </div>
                </div>

                <!-- Estoque -->
                <div class="row mt-1">
                    <div class="col-sm-12">

                        <div class="card">

                            <div class="card-header">
                                <div class="d-flex flex-wrap align-items-center">
                                    <div class="d-sm-flex text-nowrap mr-1">
                                        <h3>Estoque</h3>

                                    </div>
                                    <div class="d-sm-flex flex-nowrap ml-auto">
                                    </div>
                                </div>
                            </div>


                            <div class="card-body">

                                <div class="row">
                                    <div class="col-sm-8">

                                        <div id="chart_relEstoque01" style="height: 450px"></div>

                                        <div class="d-flex justify-content-center" style="font-size: smaller">
                                            <i>* Preços de referência da Matriz</i>
                                        </div>

                                    </div>
                                    <div class="col-sm-4">

                                        <div class="card">

                                            <!-- Totalização por Filiais -->
                                            <div class="card-header">
                                                <div class="d-flex flex-wrap align-items-center">
                                                    <div class="d-sm-flex text-nowrap mr-1">
                                                        <h5>Reposição de Estoque</h5>

                                                    </div>
                                                    <div class="d-sm-flex flex-nowrap ml-auto">
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="card-body">

                                                <div class="table-responsive-sm">

                                                    <table class="table table-sm table-striped table-hover crsr-datatable">

                                                        <thead>
                                                        <tr>
                                                            <th scope="col">Filial</th>
                                                            <th scope="col"></th>
                                                        </tr>
                                                        </thead>

                                                        <tbody>
                                                        {% for item in reposicaoEstoqueTotais.filiais %}
                                                            <tr>
                                                                <td>
                                                                    {{ item.desc_filial }}
                                                                </td>
                                                                <td class="text-right">
                                                                    <a class="btn btn-sm btn-outline-info"
                                                                       href="{{ url('relEstoque01_listReposicao', {'filter':{'descFilial': item.desc_filial, 'dtUltSaidaApartirDe': reposicaoEstoqueTotais.filter.dtUltSaidaApartirDe|default('')}}) }}"
                                                                       role="button">
                                                                        <i class="fas fa-external-link-square-alt"></i>
                                                                    </a>
                                                                </td>
                                                            </tr>
                                                        {% endfor %}
                                                        </tbody>

                                                    </table>
                                                </div>
                                            </div>

                                        </div>
                                    </div>

                                </div>


                                <div class="row">
                                    <div class="col text-right" style="font-size: smaller; color: lightgrey">
                                        Atualizado em : <b>{{ relEstoque01_dthrAtualizacao|date('d/m/Y H:i:s') }}</b>
                                    </div>
                                </div>

                            </div>


                        </div>
                    </div>


                </div>


                <!-- Compras -->
                <div class="row mt-1">
                    <div class="col-sm-12">
                        <div class="card">

                            <div class="card-header">
                                <div class="d-flex flex-wrap align-items-center">
                                    <div class="d-sm-flex text-nowrap mr-1">
                                        <h3>Compras</h3>

                                    </div>
                                    <div class="d-sm-flex flex-nowrap ml-auto">
                                        <label for="filter_relCompFor01_dts" class="my-auto">Período: </label>
                                        <input type="text" class="form-control"
                                               id="filter_relCompFor01_dts"
                                               name="filter_relCompFor01[dts]"
                                               data-mask="00/00/0000 - 00/00/0000"
                                               style="width: 180px; text-align: center"
                                               value="{{ filter.relCompFor01.dts|default('') }}">
                                        <button id="btnComprasSearch" class="btn btn-primary ml-2"><i
                                                    class="fas fa-search"></i></button>
                                    </div>
                                </div>
                            </div>


                            <div class="card-body">
                                <div id="chart_relCompFor01" style="height: 450px"></div>


                                <div class="row">
                                    <div class="col text-right" style="font-size: smaller; color: lightgrey">
                                        Atualizado em : <b>{{ relCompFor01_dthrAtualizacao|date('d/m/Y H:i:s') }}</b>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            {% endif %}


            {% if is_granted('ROLE_RELFINAN') %}

                <!-- Contas a Pagar/Receber -->
                <div class="row mt-1">
                    <div class="col-sm-12">

                        <div class="card">


                            <div class="card-header">
                                <div class="d-flex flex-wrap align-items-center">

                                    <div class="d-sm-flex text-nowrap mr-1">
                                        <h3>Contas a Pagar/Receber</h3>
                                    </div>
                                    <div class="d-sm-flex flex-nowrap ml-auto">

                                        <label for="filter_contasPagRec_filial" class="my-auto ml-2">Filial: </label>
                                        <select id="filter_contasPagRec_filial" style="width: 450px"
                                                name="filter[contasPagRec][filial]" class="ml-2"
                                                data-options="{{ filiais }}"
                                                data-val="{{ filter.contasPagRec.filial }}"></select>

                                        <label for="filter_contasPagRec_dts" class="my-auto ml-2">Período: </label>
                                        <input type="text" class="form-control"
                                               id="filter_contasPagRec_dts"
                                               name="filter[contasPagRec][dts]"
                                               data-mask="00/00/0000 - 00/00/0000"
                                               style="text-align: center; width: 200px"
                                               value="{{ filter.contasPagRec.dts|default('') }}">

                                        <button id="btnContasPagRecSearch" class="btn btn-primary ml-2"><i
                                                    class="fas fa-search"></i></button>
                                    </div>

                                </div>

                            </div>


                            <div class="card-body">
                                <div id="chart_contasPagarReceber" style="height: 450px"></div>


                                <div class="row">
                                    <div class="col text-right" style="font-size: smaller; color: lightgrey">
                                        Atualizado em : <b>{{ relCtsPagRec01_dthrAtualizacao|date('d/m/Y H:i:s') }}</b>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

            {% endif %}


        </div>
    </div>




{% endblock %}

{% block down_scripts %}
    <script src="{{ asset('build/dashboard_chartVendasTotalPorFornecedor.js') }}"></script>
    <script src="{{ asset('build/dashboard_chartVendasTotalPorVendedor.js') }}"></script>
    <script src="{{ asset('build/dashboard_chartCompras.js') }}"></script>
    <script src="{{ asset('build/dashboard_chartEstoque.js') }}"></script>
    <script src="{{ asset('build/dashboard_chartContasPagarReceber.js') }}"></script>

{% endblock %}